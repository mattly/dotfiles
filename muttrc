set realname = "Matthew Lyon"

# Change the following line to a different editor you prefer.
set editor = "vim +8"

# == Paths
set folder            = ~/.mail/
set alias_file        = ~/.mutt/aliases
set header_cache      = ~/.mutt/cache/headers
set message_cachedir  = ~/.mutt/cache/bodies
set certificate_file  = ~/.mutt/certificates
set mailcap_path      = ~/.mutt/mailcap
set tmpdir            = ~/.mutt/tmpdir
set signature         = ~/.mutt/signature

# == Basics
set beep              = no          # be quiet
set wait_key          = no          # shut up
set mbox_type         = Maildir
set timeout           = 3
set mail_check        = 0
unset move                          # gmail does this
set delete                          # don't ask
unset confirmappend                 # don't ask
set quit                            # don't ask
unset mark_old                      # don't need mutt's "old" noise
set pipe_decode                     # strip headers and eval mimes when piping
set thorough_search                 # strip headers and eval mimes for searching

# == Status Bar
set status_chars  = " *%A"
set status_format = "--[Folder: %f ]--[%r%m messages%?n? (%n new)?%?d? (%d to delete)?%?t? (%t tagged)? ]---%>-%?p?( %p postponed )?--"

# == Account Settings
folder-hook Lyonheart/* source ~/.mutt/lyonheart
folder-hook Sanehatter/* source ~/.mutt/sanehatter
set spoolfile = "+Lyonheart/INBOX"
macro index 1 '<change-folder>+Lyonheart/INBOX<enter>'
macro index 2 '<change-folder>+Sanehatter/INBOX<enter>'

source ~/.mutt/mailboxes

# == Sidebar
set sidebar_visible = no
set sidebar_width = 24
set sidebar_delim = ' '
set sidebar_shortpath = yes
set sidebar_format = "%3N %B"

# == Header Display
ignore *
unignore  From To Cc Date Subject
hdr_order from: to: cc: date: subject:

# == Index
set date_format = "%m/%d/%y %H:%M"
set index_format = "%4c %Z  %D  %-20.20F  %s"
set sort = threads
set sort_aux = 'reverse-last-date-received'
set uncollapse_jump
set sort_re
set reply_regexp = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set auto_tag
folder-hook . "exec collapse-all"

# == Pager
set pager_index_lines = 10
set pager_context = 1
set pager_stop
set menu_scroll
set tilde
set markers=no      # disable '+' at beginning of wrapped lines
set quote_regexp = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
alternative_order text/plain text/enriched text/html
auto_view text/html

# == Compose
set envelope_from                       #
set sig_dashes                          # dashes before sig
set edit_headers                        # show headers when composing
# set autoedit                            # skip straight to compose
set fast_reply                          # skip to compose when replying
unset askcc                             # don't ask for cc:
unset mime_forward                      # forward attachments as body
set forward_format = "Fwd: %s"          # format of subject when forwarding
set forward_decode                      # decode when forwarding
set attribution = "On %d, %n wrote:"    # quote header
set reply_to                            # reply using 'Reply To:' header
set reverse_name                        # reply using account received
set include                             # include message in replies
set forward_quote                       # include message in forwards
set sendmail_wait = 0

set query_command = "contacts -Sf '%eTOKEN%n' '%s' | sed -e 's/TOKEN/\t/g'"

# == PGP
set pgp_good_sign = "^gpg: Good signature from"
set pgp_sign_as = 3351BD75
set pgp_timeout=1800
set pgp_use_gpg_agent
set pgp_verify_sig
set pgp_autosign
set pgp_replysign
set pgp_replyencrypt
set pgp_replysignencrypted
set pgp_decode_command="gpg %?p?--passphrase-fd 0? --no-verbose --batch --output - %f"
set pgp_verify_command="gpg --no-verbose --batch --output - --verify %s %f"
set pgp_decrypt_command="gpg --passphrase-fd 0 --no-verbose --batch --output - %f"
set pgp_sign_command="gpg --no-verbose --batch --output - --passphrase-fd 0 --armor --detach-sign --textmode %?a?-u %a? %f"
set pgp_clearsign_command="gpg --no-verbose --batch --output - --passphrase-fd 0 --armor --textmode --clearsign %?a?-u %a? %f"
set pgp_encrypt_only_command="pgpewrap gpg --batch --quiet --no-verbose --output - --encrypt --textmode --armor --always-trust --encrypt-to 0xC9C40C31 -- -r %r -- %f"
set pgp_encrypt_sign_command="pgpewrap gpg --passphrase-fd 0 --batch --quiet --no-verbose --textmode --output - --encrypt --sign %?a?-u %a? --armor --always-trust --encrypt-to 0xC9C40C31 -- -r %r -- %f"
set pgp_import_command="gpg --no-verbose --import -v %f"
set pgp_export_command="gpg --no-verbose --export --armor %r"
set pgp_verify_key_command="gpg --no-verbose --batch --fingerprint --check-sigs %r"
set pgp_list_pubring_command="gpg --no-verbose --batch --with-colons --list-keys %r" 
set pgp_list_secring_command="gpg --no-verbose --batch --with-colons --list-secret-keys %r" 

# == Bindings
# ==== General ===========================
  # m               compose mail
  # q               quit
  # o               sync offline imap - inbox only
  # O               sync offline imap - all
  # C-l             redraw screen
    # ======================================
    # index,pager,query m mail
    # generic q quit
    # pager q exit
    # - index G fetch-mail # POP only
    # generic,pager \CL refresh
    macro index O "<shell-escape>offlineimap<enter>" "run offlineimap to sync all mail"
    macro index o "<shell-escape>offlineimap -qf INBOX<enter>" "run offlineimap to sync inbox"
    # pager Q quit
    # . index,pager V show-version
    bind index,pager V noop
    # index x exit
    # index $ sync-mailbox

# ==== Generic Navigation ================
  # b, C-b          previous screen
  # <space>, C-f    next-screen
  # gg              top
  # G               bottom
  # j               next entry
  # k               previous entry
  # <return>        view item
    # =======================================
    bind index,pager,attach b previous-page
    bind generic,pager \Cb previous-page
    bind generic,index,pager \CF next-page
    bind generic gg first-entry
    bind index gg first-entry
    bind pager gg top
    bind generic G last-entry
    bind index G last-entry
    bind pager G bottom
    # . generic H top-page
    bind generic H noop
    # generic j next-entry
    # - index,pager j next-undeleted
    bind index,pager j next-entry
    # - index,pager J next-entry
    # generic k previous-entry
    # - index,pager k previous-undeleted
    bind index,pager k previous-entry
    # - index,pager K previous-entry
    # - generic L bottom-page
    bind generic L noop
    # . browser m enter-mask
    bind browser m noop
    # . generic M middle-page
    bind generic M noop
    # - generic z next-page
    bind generic z noop
    # - generic Z previous-page
    bind generic Z noop
    bind generic,pager 1 noop
    bind generic,pager 2 noop
    bind generic,pager 3 noop
    bind generic,pager 4 noop
    bind generic,pager 5 noop
    bind generic,pager 6 noop
    bind generic,pager 7 noop
    bind generic,pager 8 noop
    bind generic,pager 9 noop
    # index,pager - previous-page
    bind index,pager - noop
    # . generic = first-entry
    bind generic = noop
    # . generic * last-entry
    bind generic * noop
    # generic ] half-down
    bind generic ] noop
    # - generic [ half-up
    bind generic [ noop
    # - index <Space> display-message
    bind generic,index <Space> next-page
    # pager <Space> next-screen
    bind index,pager <Down> noop
    bind index,pager <Up> noop
    bind index,pager <Right> noop
    bind index,pager <Left> noop
    bind index,pager <Backspace> noop
    bind index,pager <Home> noop
    bind index,pager <End> noop
    bind index,pager <PageDown> noop
    bind index,pager <PageUp> noop
    # generic <Return> display-message

# ==== Mailbox Navigation ================
  # ga              Go to All mail
  # <right>         open folder (sidebar), close sidebar
  # <down>          next folder (sidebar)
  # <up>            previous folder (sidebar)
  # <left>          toggle sidebar visibility
    # ======================================
    # . index,pager c change-folder
    bind index,pager c noop
    # browser c change-dir
    # . browser C create-mailbox # imap only
    bind browser C noop
    # . index,pager \ec change-folder-readonly
    bind index,pager \ec noop
    # browser d delete-mailbox # imap only
    macro index,pager <right> "<sidebar-open><enter-command>toggle sidebar_visible<enter>"
    bind index,pager <down> sidebar-next
    bind index,pager <up> sidebar-prev
    # browser s subscribe # imap
    bind browser s noop
    # browser T toggle-subscribed
    bind browser T noop
    # browser u unsubscribe # imap
    bind browser u noop
    # browser <tab> toggle-mailboxes
    macro index,pager <left> '<enter-command>toggle sidebar_visible<enter>'
    # browser <Space> view-file
    # index,pager,browser . buffy-list
    bind index,pager,browser . noop

# ==== Message Navigation ================
  # p recall drafts
  # ======================================
    # . browser N select-new
    bind browser N noop
    # . index,pager \CN next-thread
    bind index,pager \CN noop
    # . index,pager \en next-subthread
    bind index,pager \en noop
    # - index <Tab> next-new-then-unread
    bind generic <tab> noop
    # index \e<Tab> previous-new-then-unread
    bind generic,index \e<Tab> noop
    # . index % toggle-write
    bind index % noop
    bind index p recall-message
    # . pager P parent-message
    bind pager P noop

# ==== Search, Filtering =================
  # l               filter messages
  # L               clear filter
  # /               search
  # n               next search result
  # N               previous search result
  # S               search with notmuch
  # [               tag pattern
  # ]               untag pattern
  # >               sort
  # <               sort-reverse
  # \               search toggle
    # =======================================
    # index l limit                   # filter messages matching a pattern
    macro index L "<limit>all<enter>" "clear limit filter"
    # . index \el show-limit
    bind index \el noop
    # generic n search-next
    # - index,pager N mark-as-new
    bind index,pager N search-opposite
    # - index,pager o sort-mailbox
    # - browser o sort
    #bind index,pager,browser o noop
    # - index,pager O sort-reverse
    bind pager,browser O noop
    macro index S "<enter-command>unset wait_key<enter><shell-escape>~/.mutt/notmuch.py ~/.mail/temporary/search<enter><change-folder-readonly>+temporary/search<enter>" "search mail (using notmuch)"
    # generic > next-line
    bind generic > noop
    bind index > sort-mailbox
    bind browser > sort
    # generic < previous-line
    bind generic < noop
    bind index,browser < sort-reverse
    # generic,pager / search
    # generic,pager \e/ search-reverse

# ==== Message Operations ================
  # t               tag
  # B               bounce message
  # f               forward message
  # r               reply
  # R               reply all
  # s               flag message (star)
  # e               archive message
  # !               send to spam
  # #               send to trash
  # M               move to folder...
  # |               pipe message
    # ======================================
    # - index,pager,attach b bounce-message
    bind index,pager,attach B bounce-message
    # . index,pager C copy-message
    bind index,pager C noop
    # . index,pager \eC decode-copy
    bind index,pager \eC noop
    # . index,pager d delete-message
    bind index,pager d noop
    # . alias,postpone d delete-entry
    bind alias,postpone d noop
    # . index,pager D delete-pattern
    bind index,pager D noop
    # . index,pager e edit
    macro index,pager e "<delete-message>$" "Archive Message"
    # . index,pager,attach \cE edit-type
    bind index,pager \cE noop
    # . index,pager,attach \ee resend-message # template?
    bind index,pager,attach \ee noop
    # index,pager,attach f forward-message
    # - index,pager F flag-message
    bind index,pager F noop
    # - index,pager,attach g group-reply
    # index,pager,attach,compose h display-toggle-weed
    # . pager i exit
    bind pager i noop
    # - index,pager,attach L list-reply
    macro index M "<copy-message>?<toggle-mailboxes>" "move a message to a mailbox"
    # index,pager r reply
    # index,pager R recall-message # drafts?
    bind pager R group-reply
    # index,pager s save-message
    bind index,pager s flag-message
    # attach s save-entry
    # index,pager \es decode-save
    bind index,pager \es noop
    # generic t tag-entry
    # pager t tag-message
    # - index T tag-pattern
    # index \CT untag-pattern
    bind index \Ct noop
    # - index,pager u undelete-message
    # alias,attach,postpone u undelete-entry
    bind index,attach,alias,postpone u noop
    # index U undelete-pattern
    bind index U noop
    # index,pager w set-flag
    bind index,pager w noop
    # index,pager W clear-flag
    bind index,pager W noop
    # generic,pager ! shell-escape
    bind generic ! noop
    # ! spend to spam sourced from account config
    # index,pager @ display-address
    # # send to trash sourced from account config
    # generic ; tag-prefix
    # tag-prefix is used by default if things are tagged
    # bind generic \; noop
    bind index [ tag-pattern
    bind index ] untag-pattern
    # index,pager | pipe-message
    # attach | pipe-entry

# ==== Message Reading ===================
  # h               view headers
  # S               skip quoted material
  # T               toggle quoted
  # u               get urls
  # v               view attachments
    # ====================================
    # - attach m view-mailcap
    bind attach,query m noop
    # - index,pager p print-message
    # - attach p print-entry
    bind pager,attach p noop
    # pager S skip-quoted
    # pager T toggle-quoted
    # attach T view-text
    macro pager u "|urlview<enter>" "call urlview"
    # index,pager v view-attachments
    # attach v collapse-parts
    # . pager <Return> next-line
    bind pager <Return> noop
    # . pager ^ top
    bind pager \^ noop
    # pager \\ search-toggle

# ==== Thread Management =================
  # T               tag thread
  # z               collapse thread
  # Z               collapse all
    # ====================================
    bind index T tag-thread
    bind index z collapse-thread
    bind index Z collapse-all
    # index,pager \CD delete-thread
    bind index,pager \CD noop
    # index,pager \ed delete-subthread
    bind index,pager \ed noop
    bind pager,attach L noop
    # index,pager \CP previous-thread
    bind index,pager \CP noop
    # index,pager \ep previous-subthread
    bind index,pager \ep noop
    # index,pager \CR read-thread
    bind index,pager \CR noop
    # index,pager \er read-subthread
    bind index,pager \er noop
    # index \et tag-thread
    bind index \et noop
    # index,pager \eu undelete-subthread
    bind index,pager \eu noop
    # index,pager \cU undelete-thread
    bind index,pager \CU noop
    # index \ev collapse-thread
    bind index \ev noop
    # index \eV collapse-all
    bind index \eV noop
    # - index,pager # break-thread
    # . index,pager & link-threads
    bind index,pager \& noop

# ==== Contacts ==========================
  #
    # ====================================
    # - index,pager,query a create-alias
    bind pager,query a noop
    # query A query-append
    # index,query Q query

# ==== Security ==========================
    # ====================================
    # pgp,smime c verify-key
    # - index,pager,attach \CF forget-passphrase
    # pager,attach \CK extract-keys
    bind pager,attach \CK noop
    # index \ek mail-key
    bind index \ek noop
    # index,pager,attach \eP check-traditional-pgp
    bind index,pager,attach \eP noop

# ==== Compose ===============
  # a               attach file
  # A               attach message
  # b               edit BCC
  # c               edit cc
  # d               edit attachment description
  # D               detach file
  # C-d             toggle attachment disposition
  # e               edit message
  # E               edit headers
  # C-e             edit encoding
  # f               edit from
  # G               get-attachment
  # m               edit mime
  # p               pgp menu
  # P               postpone message
  # r               edit reply to
  # s               edit subject
  # S               smime menu
  # t               edit to
  # y               send message
  # Y               send without GPG
  # |               pipe message
  # ==========================
    # compose a attach-file
    # compose A attach-message
    # compose b edit-bcc
    # compose c edit-cc
    # compose C copy-file
    bind compose C noop
    # compose d edit-description # attachment
    # compose D detach-file
    # compose \CD toggle-disposition
    # compose e edit-message
    # compose E edit-headers
    # compose \CE edit-encoding
    # - compose f edit-fcc # save message locally to a file
    # compose \ef edit-from
    bind compose f edit-from
    # . compose F filter-entry # through shell
    bind compose F noop
    # compose \CF forget-passphrase
    # compose G get-attachment
    # compose i ispell
    bind compose i noop
    # compose \ek attach-key
    bind compose \ek noop
    # compose l print-entry
    bind compose l noop
    # compose m edit-mime
    # compose M mix
    bind compose M noop
    # compose n new-mime
    bind compose n noop
    # compose p pgp-menu
    # compose P postpone-message
    # compose r edit-reply-to
    # browser r rename-mailbox # imap
    # compose R rename-file
    bind compose R noop
    # compose s edit-subject
    # compose S smime-menu
    # compose t edit-to
    # compose \CT edit-type
    # compose u toggle-unlink # to delete after sending
    # compose U update-encoding
    # compose \CXe edit-file
    bind compose \CXe noop
    # compose y send-message
    # compose | pipe-entry
    # compose <return> view-attach
    # compose w write-fcc # write message to folder
    bind compose w noop
    # attach,compose <Return> view-attach
    bind attach <return> view-mailcap
    macro compose Y pfy "send without GPG"

# ==== Line Editor ===========
    # editor \CA bol # beginning of line
    # editor \CB backward-char
    # editor \EB backward-word
    # editor \CC capitalize-word
    bind editor \CC noop
    # editor \ed kill-eow
    # editor \CD delete-char
    # editor \CE eol
    # editor \CF forward-char
    # editor \ef forward-word
    # editor \CK kill-eol
    # editor \el downcase-word
    bind editor \el noop
    # editor \CT complete-query
    bind editor \CT complete
    # editor \cU kill-line
    # editor \eu upcase-word
    bind editor \eu noop
    # editor \CV quote-char
    # editor \CW kill-word
    # editor <space> buffy-cycle
    bind editor <space> noop
    # editor <tab> complete
    bind editor <Tab> complete-query

bind index \' change-folder

# browser @ display-filename
# pgp,smime % view-name
# generic,pager : enter-command


# === Editing

source ~/.mutt/solarized-light-16.muttrc
